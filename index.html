<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Rizznake - The Ultimate Snake Game</title>
    <meta name="description" content="Play Rizznake. Choose your character (Dashamoolam, Vasu, Sayip) and dominate the classic snake game.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #8b9c85; /* Nokia Grey/Green */
            --screen-color: #9cb094;
            --snake-body: #2d3328;
            --snake-head-dash: #e5c53d; /* Yellowish */
            --snake-head-vasu: #a83636; /* Angry Red */
            --snake-head-sayip: #3d6cb5; /* Foreign Blue */
            --food-color: #2d3328;
            --text-color: #1a1f16;
        }

        * { box-sizing: border-box; touch-action: manipulation; }
        
        body {
            margin: 0; padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Press Start 2P', monospace; /* Retro Font */
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* --- MENUS & UI --- */
        #home-screen, #game-screen {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s;
        }

        h1 { font-size: 40px; margin-bottom: 20px; text-transform: uppercase; text-shadow: 2px 2px 0px rgba(0,0,0,0.2); }
        h2 { font-size: 16px; margin-bottom: 30px; opacity: 0.8; }

        .btn {
            background: var(--snake-body);
            color: var(--screen-color);
            border: 4px solid #1a1f16;
            padding: 15px 20px;
            margin: 10px;
            font-family: inherit;
            font-size: 14px;
            cursor: pointer;
            text-transform: uppercase;
            box-shadow: 4px 4px 0px rgba(0,0,0,0.2);
            width: 280px;
        }

        .btn:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0px rgba(0,0,0,0.2); }
        
        .hidden { display: none !important; }

        /* Character Specific Buttons */
        .char-btn-0:hover { border-color: var(--snake-head-dash); color: var(--snake-head-dash); }
        .char-btn-1:hover { border-color: var(--snake-head-vasu); color: var(--snake-head-vasu); }
        .char-btn-2:hover { border-color: var(--snake-head-sayip); color: var(--snake-head-sayip); }

        /* --- GAME BOARD --- */
        .game-wrapper {
            position: relative;
            border: 10px solid var(--text-color);
            background-color: var(--screen-color);
            box-shadow: inset 0 0 20px rgba(0,0,0,0.2);
            padding: 5px;
        }

        .board {
            position: relative;
            width: 300px; height: 300px; /* Base size, JS adjusts logic */
        }

        .cell {
            position: absolute;
            width: 15px; height: 15px;
            /* Grid visual helper */
            box-shadow: inset 0 0 0 1px rgba(0,0,0,0.05); 
        }

        /* Snake Styling */
        .cell.snake { background-color: var(--snake-body); border-radius: 2px; }
        
        /* The HEAD of the snake based on character */
        .cell.snake.head.char-0 { background-color: var(--snake-head-dash); border: 2px solid #000; } /* Dashamoolam */
        .cell.snake.head.char-1 { background-color: var(--snake-head-vasu); border: 2px solid #000; } /* Vasu */
        .cell.snake.head.char-2 { background-color: var(--snake-head-sayip); border: 2px solid #000; } /* Sayip */
        
        /* Food Styling */
        .cell.food { 
            background-color: var(--text-color); 
            border-radius: 50%; 
            animation: pulse 1s infinite; 
        }

        @keyframes pulse { 0% { transform: scale(0.8); } 50% { transform: scale(1.1); } 100% { transform: scale(0.8); } }

        /* HUD */
        .hud {
            display: flex; justify-content: space-between; width: 100%; max-width: 320px;
            margin-bottom: 10px; font-size: 12px;
        }

        /* Watermark & Footer */
        .watermark {
            position: absolute; bottom: 10px; right: 10px;
            font-size: 10px; opacity: 0.5;
        }
        .adsense-privacy {
            margin-top: 20px; font-size: 8px; text-align: center; max-width: 300px; line-height: 1.5;
        }
        .adsense-privacy a { color: var(--text-color); }

        /* Responsive */
        @media (min-width: 600px) {
            .board { width: 500px; height: 400px; }
            .cell { width: 25px; height: 25px; } /* 20x16 grid */
        }

        /* Overlay Messages */
        #game-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(139, 156, 133, 0.9);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 10;
        }

        /* Ads Container */
        .ad-container { width: 100%; height: 60px; background: rgba(0,0,0,0.1); margin-top: 10px; display: flex; align-items: center; justify-content: center; font-size: 10px; }
    </style>
</head>
<body>

    <div id="home-screen">
        <h1>RIZZNAKE</h1>
        <h2>Select Character</h2>

        <button class="btn char-btn-0" onclick="startGame(0)">Dashamoolam (Minimal)</button>
        <button class="btn char-btn-1" onclick="startGame(1)">Vasu (Aggressive)</button>
        <button class="btn char-btn-2" onclick="startGame(2)">Sayip (Chaos)</button>

        <div class="adsense-privacy">
            <p>Built by [Your Name Here]</p>
            <p>Rizznake is a fan-made game for fun.</p>
            <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a>
        </div>
        
        <div class="ad-container">Google AdSense Space</div>
    </div>

    <div id="game-screen" class="hidden">
        <div class="hud">
            <span>SCORE: <span id="scoreVal">0</span></span>
            <span id="charName">P1</span>
        </div>

        <div class="game-wrapper">
            <div id="board" class="board"></div>
            
            <div id="game-overlay" class="hidden">
                <h2 id="overlay-msg">GAME OVER</h2>
                <button class="btn" onclick="resetGame()">RESTART</button>
                <button class="btn" onclick="goHome()">HOME</button>
            </div>
        </div>

        <div style="margin-top: 20px; opacity: 0.6; font-size: 10px;">
            Swipe to Move / Arrow Keys
        </div>

        <div class="watermark">Rizznake Â© 2024</div>
    </div>

    <script>
        // --- GAME CONFIGURATION ---
        const config = {
            gridX: 20, // Width in cells
            gridY: 16, // Height in cells
            speed: 120 // Milliseconds per frame (lower is faster)
        };

        const characters = [
            { name: "Dashamoolam", colorClass: "char-0", soundType: "sine", pitch: 1 },
            { name: "Vasu Annan", colorClass: "char-1", soundType: "sawtooth", pitch: 0.5 },
            { name: "Sayip", colorClass: "char-2", soundType: "square", pitch: 2.0 }
        ];

        // --- STATE ---
        let state = {
            snake: [],
            direction: { x: 0, y: 0 },
            nextDirection: { x: 0, y: 0 },
            food: { x: 0, y: 0 },
            score: 0,
            running: false,
            paused: false,
            characterIndex: 0,
            lastRender: 0
        };

        let audioCtx = null;

        // --- DOM ELEMENTS ---
        const boardEl = document.getElementById('board');
        const scoreEl = document.getElementById('scoreVal');
        const charNameEl = document.getElementById('charName');
        const overlayEl = document.getElementById('game-overlay');
        const overlayMsg = document.getElementById('overlay-msg');
        const homeScreen = document.getElementById('home-screen');
        const gameScreen = document.getElementById('game-screen');

        // --- AUDIO ENGINE (Browser Synth) ---
        function initAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        }

        function playSound(type) {
            if (!audioCtx) initAudio();
            if (audioCtx.state === 'suspended') audioCtx.resume();

            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            const char = characters[state.characterIndex];
            
            // Apply character personality to sound
            osc.type = char.soundType; 
            
            let frequency = 440;
            let duration = 0.1;

            if (type === 'eat') {
                frequency = 600 * char.pitch;
                duration = 0.1;
            } else if (type === 'die') {
                frequency = 150 * char.pitch;
                duration = 0.5;
                osc.type = 'sawtooth'; // Always harsh for death
            } else if (type === 'move') {
                // Very quiet click
                frequency = 100;
                duration = 0.05;
                gainNode.gain.value = 0.1;
            }

            osc.frequency.setValueAtTime(frequency, audioCtx.currentTime);
            if(type === 'eat') osc.frequency.exponentialRampToValueAtTime(frequency * 2, audioCtx.currentTime + duration);
            if(type === 'die') osc.frequency.exponentialRampToValueAtTime(10, audioCtx.currentTime + duration);

            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);

            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            osc.stop(audioCtx.currentTime + duration);
        }

        // --- GAME LOGIC ---

        function startGame(charIndex) {
            initAudio();
            state.characterIndex = charIndex;
            charNameEl.textContent = characters[charIndex].name;
            
            homeScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            
            resetGame();
        }

        function goHome() {
            state.running = false;
            gameScreen.classList.add('hidden');
            homeScreen.classList.remove('hidden');
        }

        function resetGame() {
            // Calculate grid size based on responsive board size
            const boardRect = boardEl.getBoundingClientRect();
            // We use fixed 20x16 grid for simplicity, cell size adjusts via CSS
            
            state.snake = [{x: 10, y: 10}, {x: 10, y: 11}, {x: 10, y: 12}];
            state.direction = {x: 0, y: -1}; // Start moving up
            state.nextDirection = {x: 0, y: -1};
            state.score = 0;
            state.running = true;
            state.paused = false;
            scoreEl.innerText = state.score;
            overlayEl.classList.add('hidden');

            placeFood();
            window.requestAnimationFrame(gameLoop);
        }

        function placeFood() {
            let valid = false;
            while (!valid) {
                state.food = {
                    x: Math.floor(Math.random() * config.gridX),
                    y: Math.floor(Math.random() * config.gridY)
                };
                // Ensure food doesn't spawn on snake
                valid = !state.snake.some(segment => segment.x === state.food.x && segment.y === state.food.y);
            }
        }

        function gameLoop(currentTime) {
            if (!state.running) return;

            window.requestAnimationFrame(gameLoop);
            
            const secondsSinceLastRender = (currentTime - state.lastRender) / 1000;
            if (secondsSinceLastRender < config.speed / 1000) return;
            
            state.lastRender = currentTime;
            update();
            draw();
        }

        function update() {
            if (state.paused) return;

            state.direction = state.nextDirection;

            const head = { ...state.snake[0] };
            head.x += state.direction.x;
            head.y += state.direction.y;

            // Wall Collision Check (Game Over)
            if (head.x < 0 || head.x >= config.gridX || head.y < 0 || head.y >= config.gridY) {
                gameOver();
                return;
            }

            // Self Collision Check
            if (state.snake.some(segment => segment.x === head.x && segment.y === head.y)) {
                gameOver();
                return;
            }

            state.snake.unshift(head); // Add new head

            // Check Food
            if (head.x === state.food.x && head.y === state.food.y) {
                state.score += 10;
                scoreEl.innerText = state.score;
                playSound('eat');
                placeFood();
                // Don't pop tail (grow)
            } else {
                state.snake.pop(); // Remove tail
            }
        }

        function draw() {
            boardEl.innerHTML = '';
            
            // Draw Food
            const foodDiv = document.createElement('div');
            foodDiv.style.left = (state.food.x * (100/config.gridX)) + '%';
            foodDiv.style.top = (state.food.y * (100/config.gridY)) + '%';
            foodDiv.style.width = (100/config.gridX) + '%';
            foodDiv.style.height = (100/config.gridY) + '%';
            foodDiv.classList.add('cell', 'food');
            boardEl.appendChild(foodDiv);

            // Draw Snake
            state.snake.forEach((segment, index) => {
                const snakeDiv = document.createElement('div');
                snakeDiv.style.left = (segment.x * (100/config.gridX)) + '%';
                snakeDiv.style.top = (segment.y * (100/config.gridY)) + '%';
                snakeDiv.style.width = (100/config.gridX) + '%';
                snakeDiv.style.height = (100/config.gridY) + '%';
                
                snakeDiv.classList.add('cell', 'snake');
                if (index === 0) {
                    snakeDiv.classList.add('head', characters[state.characterIndex].colorClass);
                }
                boardEl.appendChild(snakeDiv);
            });
        }

        function gameOver() {
            state.running = false;
            playSound('die');
            overlayMsg.innerText = "GAME OVER\n" + characters[state.characterIndex].name + " Failed!";
            overlayEl.classList.remove('hidden');
        }

        // --- INPUT HANDLING ---
        window.addEventListener('keydown', e => {
            switch (e.key) {
                case 'ArrowUp':
                    if (state.direction.y === 0) state.nextDirection = { x: 0, y: -1 };
                    break;
                case 'ArrowDown':
                    if (state.direction.y === 0) state.nextDirection = { x: 0, y: 1 };
                    break;
                case 'ArrowLeft':
                    if (state.direction.x === 0) state.nextDirection = { x: -1, y: 0 };
                    break;
                case 'ArrowRight':
                    if (state.direction.x === 0) state.nextDirection = { x: 1, y: 0 };
                    break;
            }
        });

        // Touch Support
        let touchStartX = 0;
        let touchStartY = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        }, {passive: false});

        document.addEventListener('touchmove', e => {
            if(!state.running) return;
            e.preventDefault(); // Stop scrolling
        }, {passive: false});

        document.addEventListener('touchend', e => {
            if(!state.running) return;
            const touchEndX = e.changedTouches[0].screenX;
            const touchEndY = e.changedTouches[0].screenY;
            
            const dx = touchEndX - touchStartX;
            const dy = touchEndY - touchStartY;

            if (Math.abs(dx) > Math.abs(dy)) {
                // Horizontal
                if (dx > 0 && state.direction.x === 0) state.nextDirection = { x: 1, y: 0 };
                else if (dx < 0 && state.direction.x === 0) state.nextDirection = { x: -1, y: 0 };
            } else {
                // Vertical
                if (dy > 0 && state.direction.y === 0) state.nextDirection = { x: 0, y: 1 };
                else if (dy < 0 && state.direction.y === 0) state.nextDirection = { x: 0, y: -1 };
            }
        }, {passive: false});

    </script>
</body>
</html>
